[pytest]
testpaths = tests
python_files = test_*.py
python_classes = Test*
python_functions = test_*

markers =
    security: Mark test as security-related for filtering and categorization
    severity: Test severity level indicator
    critical: Critical severity - immediate security risk requiring urgent attention
    high: High severity - significant security risk requiring prompt action
    medium: Medium severity - moderate security risk requiring timely remediation
    low: Low severity - minor security concern with lower priority
    info: Informational - security finding for awareness without immediate risk
    owasp_llm01: OWASP LLM01 - Prompt Injection (CWE-77, CWE-78, CWE-94) - Manipulating LLM via crafted inputs
    owasp_llm02: OWASP LLM02 - Sensitive Information Disclosure (CWE-200, CWE-359, CWE-522) - LLM reveals confidential data
    owasp_llm03: OWASP LLM03 - Supply Chain Vulnerabilities (CWE-1329, CWE-829, CWE-494) - Vulnerabilities in components/models
    owasp_llm04: OWASP LLM04 - Model Denial of Service (CWE-400, CWE-770, CWE-920) - Resource exhaustion attacks
    owasp_llm05: OWASP LLM05 - Insecure Output Handling (CWE-79, CWE-89, CWE-74, CWE-94) - Inadequate validation of LLM outputs
    owasp_llm06: OWASP LLM06 - Insecure Plugin/Tool Use (CWE-285, CWE-862, CWE-863) - Inadequate plugin access control
    owasp_llm07: OWASP LLM07 - System Prompt Leakage (CWE-200, CWE-209, CWE-497) - Extraction of system prompts
    owasp_llm08: OWASP LLM08 - Excessive Agency (CWE-250, CWE-269, CWE-732) - LLM granted excessive permissions
    owasp_llm09: OWASP LLM09 - Overreliance (CWE-1024, CWE-693) - Excessive dependency on LLM outputs
    owasp_llm10: OWASP LLM10 - Model Theft (CWE-284, CWE-306, CWE-311) - Unauthorized access to proprietary models

addopts =
    -v
    --strict-markers
    --tb=short

sarif_output = results/pytest-results.sarif
